from keras.models import load_model
import numpy as np
import pandas as pd

model = load_model('general_object_recognition.h5')

df_test = pd.read_csv(r'Normalized_Data\scans_angle_2_8125_pos_10_rot_1_normalized.csv')
X = df_test.iloc[1438,:-1]
#X= np.array([0.0,-0.2142766915512002,-0.0435145761322489,0.1197270550835687,0.2660286608669884,0.3879839283479227,0.4808150611199631,0.5426206329165448,0.5742362540869148,0.578747059514956,0.5607427601104631,0.5254427096805792,0.477834543510488,0.4219631370760581,0.3604782242342639,0.294503711130494,0.2238368745264218,0.1474300679556335,0.0640601851894228,-0.0269404660434187,-0.1250289801312221,-0.2279976233475862,-0.3318132500266307,-0.4307949187690056,-0.5181182269042316,-0.5865799208014024,-0.6295113104814536,-0.6417012597870455,-0.6201836918145345,-0.5647618557112366,-0.4781795976332529,-0.3659028128330105,-0.2355339458556678,-0.0959395056139973,0.043783980867869,0.1753536716547208,0.2921988058860136,0.3900800137914761,0.4673382233129124,0.5247392362699077,0.5649435884039913,0.5916911266786813,0.6088363870232159,0.6193967905337072,0.6247764502872224,0.6243033839313095,0.6151705368693823,0.5928081438350481,0.5516460203656985,0.4861599197956425,0.3920461698821968,0.2673414392717748,0.1133044142147443,-0.0650959321334121,-0.2591884687308059,-0.4571379720874138,-0.6449700920200436,-0.8079677295905087,-0.9322658212739828,-1.0064376964317592,-1.0228614080045535,-0.97867987255989,-0.8762210002585457,-0.7228159619570579,-0.5300350994072438,-0.3124400538256616,-0.0860160532429658,0.133509499919923,0.3322430621989978,0.4993946778717091,0.6280869961467246,0.7156171699684326,0.7631646845316018,0.7750173848568165,0.7574553414158383,0.717477885413013,0.661576584310337,0.5947437583249109,0.5198645697126683,0.4375771864768607,0.3466097292338692,0.2445261604971702,0.1287475616867412,-0.0023296903051299,-0.1483146757611399,-0.3060845267584893,-0.4694704842198312,-0.6294455099351851,-0.7748152640014495,-0.8933366268975089,-0.9731205913391818,-1.0041293868425938,-0.9795582280817674,-0.8969031265725675,-0.7585562908771052,-0.5718339954376909,-0.3484192338466013,-0.1032817493341761,0.1467904685954026,0.3848617044409466,0.5955086193455752,0.7662616124378836,0.8886523607567443,0.9587496930414572,0.9771385919954464,0.9483744310616772,0.8800152695556434,0.7813890282986102,0.6622821472390257,0.5317380925857018,0.3971282572839458,0.2636089023538914,0.1340136917146155,0.0091620788378339,-0.1115001019130906,-0.2290604315933808,-0.3442595447608638,-0.456731210143134,-0.564499246266545,-0.6638223399619743,-0.7494188114000728,-0.81504006035871,-0.854303778718623,-0.8616549620682595,-0.8333008680800619,-0.7679685659154021,-0.6673600001986366,-0.536225273786048])
X_reshaped = np.expand_dims(X.values, axis=0).astype('float32')
print(X.info())

predicttions = model.predict(X_reshaped)

predicted_class = np.argmax(predicttions, axis=1)

print(predicted_class)